

CREATE OR REPLACE STORAGE INTEGRATION EMPLOYEE_EXTERNAL_STAGE_INTEGRATION
  TYPE = EXTERNAL_STAGE
  STORAGE_PROVIDER = S3
  STORAGE_AWS_ROLE_ARN = 'arn:aws:iam::001234567890:role/data'
  ENABLED = TRUE
  STORAGE_ALLOWED_LOCATIONS = ('s3://data/employee/', 's3://data/news/')
  STORAGE_BLOCKED_LOCATIONS = ('s3://data/customer/', 's3://data/finance/');


DESC STORAGE INTEGRATION EMPLOYEE_EXTERNAL_STAGE_INTEGRATION;


#URL ALLOWED BY INTEGRATION
CREATE OR REPLACE STAGE EMPLOYEE_DATA_FROM_INTEGRATION 
STORAGE_INTEGRATION = EMPLOYEE_EXTERNAL_STAGE_INTEGRATION
URL = 's3://data/employee/'
FILE_FORMAT = EMP_CSV


#URL NOT ALLOWED BY INTEGRATION
CREATE OR REPLACE STAGE EMPLOYEE_DATA_FROM_INTEGRATION 
STORAGE_INTEGRATION = EMPLOYEE_EXTERNAL_STAGE_INTEGRATION
URL = 's3://data/finance/'
FILE_FORMAT = EMP_CSV





